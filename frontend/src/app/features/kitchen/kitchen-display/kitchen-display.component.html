<div class="kitchen-display-container">
  <div class="header">
    <h1>Kitchen Display</h1>
    <button mat-icon-button (click)="loadOrders()" [disabled]="isLoading" title="Refresh">
      <mat-icon>refresh</mat-icon>
    </button>
  </div>

  @if (isLoading && orders.length === 0) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
    </div>
  } @else {
    <div class="orders-grid">
      @if (orders.length === 0) {
        <div class="empty-state">
          <mat-icon>restaurant_menu</mat-icon>
          <p>No orders in kitchen queue</p>
        </div>
      } @else {
        @for (order of orders; track order.id) {
          <mat-card class="order-card" [class.status-submitted]="order.status === OrderStatus.Submitted"
                    [class.status-preparation]="order.status === OrderStatus.InPreparation"
                    [class.status-ready]="order.status === OrderStatus.Ready">
            <mat-card-header>
              <mat-card-title>{{ order.orderNumber }}</mat-card-title>
              <mat-card-subtitle>Table: {{ order.tableNumber || 'Take Away' }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="order-items">
                <h4>Items:</h4>
                <ul>
                  @for (line of order.lines; track line.menuItemId) {
                    <li>{{ line.quantity }}x {{ line.name }} - ${{ (line.price * line.quantity).toFixed(2) }}</li>
                  }
                </ul>
              </div>
              <div class="order-total">
                <strong>Total: ${{ order.totalAmount.toFixed(2) }}</strong>
              </div>
              <mat-chip [color]="getStatusColor(order.status)">{{ order.status }}</mat-chip>
            </mat-card-content>
            <mat-card-actions>
              @if (order.status === OrderStatus.Submitted) {
                <button mat-raised-button color="primary" (click)="updateOrderStatus(order.id, OrderStatus.InPreparation)">
                  <mat-icon>play_arrow</mat-icon>
                  Start Preparation
                </button>
              }
              @if (order.status === OrderStatus.InPreparation) {
                <button mat-raised-button color="accent" (click)="updateOrderStatus(order.id, OrderStatus.Ready)">
                  <mat-icon>check</mat-icon>
                  Mark Ready
                </button>
              }
            </mat-card-actions>
          </mat-card>
        }
      }
    </div>
  }
</div>

